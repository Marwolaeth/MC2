# Fitting and polishing {#sec-fitting-polishing}

```{r child="../starter.Rmd"}
```

```{r include=FALSE}
book_file_name <- "modeling/03-linear-combinations.html"
```

In [Chapter -@sec-assembling] we discussed a framework for building on pattern-book functions by use of ***input scaling*** and ***output scaling***, as with:

$$\text{tide}(t) \equiv A \sin\left(a (t - t_0)\right) + B\ .$$
In this chapter, we'll build on both these ideas to make them easier to use:

- input scaling will become ***parameter selection***: We'll give standard procedures that allow you to determine by eye the input-scaling parameters for the functions $\exp()$, $\sin()$, gaussian(), and sigmoid(). These will be similar in spirit to the procedures you learned in high-school for finding the parameters of the straight-line function from visually identifiable aspects such as the slope and y-intercept.

- output scaling will become finding ***linear combinations***: We'll generalize the idea beyond the A/B format used in [@sec-assembling] to include finding linear combinations of any numbers of functions, e.g. $A f(x) + B g(x) + C h(y) + \ldots$. The importance of building linear combinations can hardly be overstated. In fact, Block 5 of *MOSAIC Calculus* is entirely about this.

Taken together, the tools of parameter selection and finding linear combination support a standard process for building model functions. 

## Parameter names

The functions we will work with in this chapter either have no parameters (e.g. one() or identity()) of have standard formats and names for parameters. 

The gaussian and sigmoid share the same parameters: "mean" and "sd" (short for "standard deviation").

The exponential function is written in several different forms with different parameter names. Perhaps the most standard is $\exp(k t)$ with "k" as the parameter name. Closely related is the form $\exp(-k t)$, which is used especially for exponential decay. Another form often seen is $\exp(-t / \tau)$, where the parameter $\tau$ (a Greek letter pronounced "tau") is the "time constant." In practice, as you'll see, it's common to estimate quantities called the "doubling time" or "half-life," which are relatively easy to read from a graph, but then have to be converted the $k$ or $\tau$ form.

For the sinusoid, we will often use the form $\sin\left(\frac{2\pi}{P} (t- t_0)\right)$, where the parameter $P$ is the "period" of oscillation. But in fields such as engineering or physics one frequently encounters the sinusoid parameterized by "frequency" or "angular frequency" or "wave number" or "wavelength." All of these get at the same characteristic as "period," but in ways that are more or less convenient depending on the application. 

## Straight-line function


## Gaussian and Sigmoid

## Sinusoid

## Exponential





## FROM EARLIER INTRO

introduced three important techniques for constructing new functions out of existing ones:

- Composition, e.g. $f(g(x))$
- Multiplication, e.g. $f(x) g(x)$ or, a function with two inputs, $f(y) g(x)$
- Linear combination, e.g. $A f(x) + B\, g(x)$ or, a function with two inputs, $A f(y) + B\, g(x)$

Don't be misled by the short examples: any of the three techniques can be used to combine any number of combinations. In [Chapter -@sec-low-order, for instance, you'll see instances when we flexibly build new functions with two inputs by linearly combining six standard functions.

This chapter is about the uses of linear combination 





We've discussed ***shifting the baseline*** of the exponential and sinusoid functions by adding a constant to the basic modeling function, like this:

$$f(t) \equiv A e^{kt} + C\\
\ \\
g(t) \equiv A \sin\left(\frac{2\pi}{P} t\right) + C$$

We've called this output scaling. It's an example of a much more general and powerful way of contructing modeling functions called ***linear combinations***.

In a linear combination, you start with one or more basic functions. For discussion, let's call these $f_1(t)$, $f_2(t)$, $f_3(t)$ and so on. In making a linear combination, multiply each of the basic functions by some quantity and add the results together:

$$\text{linear combination of}\ f_1(t)\ \text{and}\ f_2(t): \ \ A_1 f_1(t) + A_2 f_2(t)$$
The quantities $A_1$ and $A_2$ are called ***scalars*** because they **scale** the functions. (In [Chapter -@sec-vectors you will see that we make a distinction between a **scalar**, which is a single quantity, and a **vector**, which is a set of scalars.)

::: {.example data-latex=""}
NEATEN THIS UP!!

Linear combination to represent phase shift.
$\sin(x + \phi) = \cos(\phi)\sin(x) + \sin(\phi) \cos(x)$

$C \sin(x +\phi) = A \sin(x) + B \cos(x)$ where $C^2 = A^2 + B^2$ and $\phi=\arctan(A/B)$
:::

It's common to take linear combinations of functions with different inputs, for example
$$h(x, y, t) \equiv 4 e^{-kt} + 7 y + 2\,\pnorm(x-3) - 19$$

In fields like statistics and economics and other social sciences, as well as clinical medical research, a great number of modeling techniques involve such combinations of functions of various inputs.

In engineering and physics, an important class of functions involves a linear combination of many sinusoids of different periods, e.g. 

$$\text{signal}(t) \equiv A_1 \sin\left(\frac{2 \pi}{P_1}t\right) + 
A_2 \sin\left(\frac{2 \pi}{P_2}t\right) + 
A_3 \sin\left(\frac{2 \pi}{P_3}t\right) + \cdots$$

Linear combination of functions provides a powerful and flexible general-purpose modeling technique in part because many physical systems seem to work this way and in part because the methods for finding the scalars---$A_1$, $A_2$, and so on---have an extremely strong theory and fast computer implementations that automatically solve the problem once the modeler has selected the functions she wants to combine. In Block 4, we use the name ***target problem*** to refer the problem of finding scalars to match as well as possible a linear combination to data.

An expression like $A e^{kx} + C$ combines the exponential (obviously!) and a second function that isn't immediately obvious: the constant function $\text{constant}(x) \equiv 1$. It might be overkill to re-write the expression as $A e^{kx} + C\, \text{constant}(x)$ but get in the habit of seeing the constant function as a constant presence in linear combinations!

Polynomials are an important example of linear combinations. Something like $p(x) \equiv a + b t + c t^2$ is a linear combination of the constant function, the proportional function, and the square function. 



## Exercises

`r if (knitr::is_latex_output()) knitr::knit_exit()`




`r insert_calcZ_exercise(12.4, "dB1r5F", "Exercises/spider-tear-plant.Rmd")`

`r insert_calcZ_exercise(12.5, "drawing", "Exercises/drawing.Rmd")`

`r insert_calcZ_exercise(12.6, "daylength", "Exercises/length-of-day.Rmd")`


`r insert_calcZ_exercise("XX.XX", "p6jxx5", "/Users/kaplan/MC2/Modeling/Exercises/duck-see-socks.Rmd", skill="linear combinations")`




## Drill

`r Znotes:::MC_counter$reset(labels="roman")`



